Normalization and simple transformation

Since morphological profiling features typically measure diverse cell phenotypes covering intensity, shape, and texture, feature distributions can have very different shapes. This is at odds with feature distribution shapes from other profiling technologies such as gene expression, which tend to be more homogeneous since the quantities being measured are usually all counts, or all intensities. Feature transformation is therefore a critical consideration for morphological profiling. The standard in the field is currently to perform some type of logarithmic transformation, which tends to make feature distributions more symmetric and homoskedastic, and generally leads to superior model fits when correcting for spatial effects or performing downstream statistical analysis. A generalized logarithm has been successfully applied in recent profiling screens, which behaves as the natural logarithm for high feature values, and uses a shrinkage parameter to control noise, for negative or near-zero feature values. The shrinkage parameter can be chosen empirically, or more systematically using packages such as vsn (an approach that gained popularity in the microarray field). Transformation can be done using the cell-level data, or using per-well profiles.

In all profiling screens, diagnostic plots should be generated and inspected to assess for systematic artifacts. If spatial biases are present on plates, standard methods used for correction include Bscore and locfit. Bscore implements a two-way median polish over row and columns, and can only be used when biological effects are not heavily confounded with technical biases in a column- or row-wise fashion e.g. when key controls are placed over a single column, and not distributed over the plate. Locfit and related methods such as running averages, fit a smoothing surface to the plate using local spatial averaging, and return fitting residuals as spatial-corrected values. Both Bscore and locfit methods are available in the Bioconductor high-throughput screening package cellHTS2, and are readily applicable to morphological profiling data. For experiments that are conducted over a long time period, systematic drift in feature values over time should also be assessed and corrected for using smoothing techniques.

Normalization in morphological profiling typically refers to the scoring of feature values relative to controls so that the magnitude of a phenotypic effect can be assessed, and feature values can be put on a common scale. Normalization strategies should be assessed before the screen when the experiment is being designed, so biologists and analysts can agree on the choice and layout of relevant controls. A popular normalization choice on the plate level is the robust z-score (i.e. z-score with median and MAD). The robust z-score is less affected by outliers than the standard z-score, and is therefore often more useful in applied settings. If the expectation is that few wells on a plate will be phenotypically affected by the experimental treatment or condition, the z-score can simply be applied across all wells without the need for additional controls. When direct comparison to positive or negative controls is desirable, useful methods include Percent Of Control (POC), and Normalized Percent Inhibition (NPI). POC does as the name suggests, and can be performed with respect to a single control group. NPI subtracts the positive control average and divides by the difference between the positive control and negative control averages. Finally, if absolute comparisons across plates must be done, normalizing against a common set of reference controls can be performed. In all cases, systematic differences between feature values between batches should also be assessed and corrected for. For this purpose the robust z-score is again useful.


